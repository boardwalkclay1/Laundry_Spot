<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Payment Methods â€“ Laundry Bubbles</title>
</head>
<body>
    <h1>Payment Methods</h1>

    <p id="currentMethod">Loading...</p>

    <button onclick="savePayment()">Add / Update Payment Method</button>
    <br><br>
    <a href="settings.html">Back</a>

    <script type="module">
        import { supabase } from "./supabase.js";

        const { data: { session } } = await supabase.auth.getSession();
        if (!session) window.location.href = "login.html";

        const { data: profile } = await supabase
            .from("profiles")
            .select("*")
            .eq("id", session.user.id)
            .single();

        document.getElementById("currentMethod").textContent =
            profile.payment_method
            ? `Current: ${profile.payment_method}`
            : "No payment method saved.";

        window.savePayment = async function () {
            const method = prompt("Enter payment method:");
            if (!method) return;

            await supabase
                .from("profiles")
                .update({ payment_method: method })
                .eq("id", session.user.id);

            alert("Saved!");
            location.reload();
        }
    </script>
</body>
</html>
