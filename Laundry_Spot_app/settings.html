<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Settings – Laundry Bubbles</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root { --primary:#4da6ff;--accent:#7a5cff;--text:#f9fbff;--muted:#9aa3c7;--card:rgba(255,255,255,0.05); }
    *{margin:0;padding:0;box-sizing:border-box;font-family:system-ui,sans-serif;}
    body{
      min-height:100vh;
      background:
        radial-gradient(circle at 20% 20%,rgba(77,166,255,0.18),transparent 60%),
        radial-gradient(circle at 80% 80%,rgba(122,92,255,0.18),transparent 60%),
        #030715;
      color:var(--text);
      padding:18px;
      overflow-x:hidden;
      position:relative;
    }
    .grid-overlay{
      position:fixed;inset:0;
      background-image:
        linear-gradient(rgba(255,255,255,0.06) 1px,transparent 1px),
        linear-gradient(90deg,rgba(255,255,255,0.05) 1px,transparent 1px);
      background-size:48px 48px;
      opacity:0.35;pointer-events:none;z-index:0;
    }
    header{
      display:flex;align-items:center;gap:12px;
      margin-bottom:20px;position:relative;z-index:2;
    }
    .back{
      width:36px;height:36px;border-radius:50%;
      background:rgba(255,255,255,0.08);
      border:1px solid rgba(255,255,255,0.15);
      display:flex;align-items:center;justify-content:center;
      cursor:pointer;font-size:18px;
    }
    h1{font-size:22px;font-weight:600;}
    .section{margin-bottom:26px;position:relative;z-index:2;}
    .section-title{
      font-size:14px;color:var(--muted);margin-bottom:10px;
      text-transform:uppercase;letter-spacing:1px;
    }
    .card{
      background:var(--card);
      border:1px solid rgba(255,255,255,0.12);
      border-radius:16px;
      padding:16px;
      margin-bottom:12px;
      box-shadow:0 10px 24px rgba(0,0,0,0.4);
    }
    label{
      font-size:13px;color:var(--muted);
      display:block;margin-bottom:4px;
    }
    input,select{
      width:100%;padding:10px;border-radius:12px;
      border:1px solid rgba(255,255,255,0.12);
      background:rgba(255,255,255,0.06);
      color:var(--text);
      margin-bottom:12px;
      font-size:14px;
    }
    .btn{
      width:100%;padding:12px;border-radius:999px;
      border:none;cursor:pointer;font-weight:600;
      font-size:16px;margin-top:8px;
    }
    .btn-primary{
      background:linear-gradient(135deg,var(--primary),var(--accent));
      color:#fff;box-shadow:0 12px 28px rgba(77,166,255,0.45);
    }
    .btn-danger{
      background:rgba(255,0,0,0.15);
      border:1px solid rgba(255,0,0,0.3);
      color:#ff6b6b;
    }
    .nav-card{display:flex;justify-content:space-between;align-items:center;cursor:pointer;}
    .nav-title{font-size:15px;font-weight:500;}
    .nav-sub{font-size:12px;color:var(--muted);}
  </style>
</head>
<body>
  <div class="grid-overlay"></div>

  <header>
    <div class="back" id="backBtn">←</div>
    <h1>Settings</h1>
  </header>

  <div class="section">
    <div class="section-title">Profile</div>
    <div class="card">
      <label>Full name</label>
      <input id="fullName" placeholder="Your name" />
      <label>Email</label>
      <input id="email" placeholder="Email" disabled />
      <label>Phone</label>
      <input id="phone" placeholder="Phone number" />
      <button class="btn btn-primary" id="saveProfileBtn">Save profile</button>
    </div>
  </div>

  <div class="section">
    <div class="section-title">Mode</div>
    <div class="card">
      <label>Current mode</label>
      <select id="roleSelect">
        <option value="client">Client</option>
        <option value="washer">Washer</option>
      </select>
      <button class="btn btn-primary" id="saveRoleBtn">Switch mode</button>
    </div>
  </div>

  <div class="section">
    <div class="section-title">Money</div>
    <div class="card nav-card" id="clientPaymentCard">
      <div>
        <div class="nav-title">Client payment method</div>
        <div class="nav-sub">How you pay for loads and tips.</div>
      </div>
      <div style="font-size:18px;color:var(--muted);">›</div>
    </div>
    <div class="card nav-card" id="washerPayoutCard">
      <div>
        <div class="nav-title">Washer payout method</div>
        <div class="nav-sub">How you get paid when in washer mode.</div>
      </div>
      <div style="font-size:18px;color:var(--muted);">›</div>
    </div>
  </div>

  <div class="section">
    <div class="section-title">Account</div>
    <div class="card">
      <button class="btn btn-danger" id="logoutBtn">Log out</button>
    </div>
  </div>

  <script>
    function nav(page){ window.location.href = page; }

    document.getElementById("clientPaymentCard").onclick = () => nav("client-payment.html");
    document.getElementById("washerPayoutCard").onclick = () => nav("washer-payout.html");

    document.getElementById("backBtn").onclick = () => {
      const raw = localStorage.getItem("lb_user");
      if(!raw){ nav("login.html"); return; }
      const u = JSON.parse(raw);
      nav(u.role === "washer" ? "washer-dashboard.html" : "client-dashboard.html");
    };

    let user = null;
    try{
      const raw = localStorage.getItem("lb_user");
      if(raw){
        user = JSON.parse(raw);
        document.getElementById("fullName").value = user.full_name || "";
        document.getElementById("email").value = user.email || "";
        document.getElementById("phone").value = user.phone || "";
        document.getElementById("roleSelect").value = user.role || "client";
      }
    }catch(e){}

    document.getElementById("saveProfileBtn").onclick = () => {
      if(!user) return;
      user.full_name = document.getElementById("fullName").value.trim();
      user.phone = document.getElementById("phone").value.trim();
      localStorage.setItem("lb_user", JSON.stringify(user));
      alert("Profile updated.");
    };

    document.getElementById("saveRoleBtn").onclick = () => {
      if(!user) return;
      const role = document.getElementById("roleSelect").value;
      user.role = role;
      localStorage.setItem("lb_user", JSON.stringify(user));
      alert("Mode switched to " + role + ".");
      nav(role === "washer" ? "washer-dashboard.html" : "client-dashboard.html");
    };

    document.getElementById("logoutBtn").onclick = () => {
      localStorage.removeItem("lb_user");
      localStorage.removeItem("lb_selected_washer");
      localStorage.removeItem("lb_pickup_location");
      localStorage.removeItem("lb_pickup_history");
      localStorage.removeItem("lb_conversations");
      localStorage.removeItem("lb_active_conversation");
      nav("login.html");
    };
  </script>
</body>
</html>
