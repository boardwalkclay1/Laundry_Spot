<!DOCTYPE html>
<html>
<head>
  <title>Washer Onboarding</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
  <h2>Washer Onboarding</h2>
  <button onclick="location.href='washer-dashboard.html'" style="float:right;">Back</button>

  <input id="email" placeholder="Stripe Email" type="email">

  <button onclick="startOnboarding()">Start Stripe Onboarding</button>

  <p id="status" style="margin-top:20px;"></p>
</div>

<script>
async function startOnboarding() {
  const email = document.getElementById("email").value.trim();
  if (!email) {
    document.getElementById("status").innerText = "Enter your email.";
    return;
  }

  try {
    const accountRes = await fetch("/api/washer/create-account", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ email })
    });

    const { accountId } = await accountRes.json();

    const linkRes = await fetch("/api/washer/create-account-link", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ accountId })
    });

    const { url } = await linkRes.json();
    window.location.href = url;
  } catch (e) {
    document.getElementById("status").innerText = "Error starting onboarding.";
  }
}
</script>

</body>
</html>
